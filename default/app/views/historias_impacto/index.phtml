<div class="container py-4" style="border-radius:12px;">

    <!-- Encabezado -->
    <div style="text-align:center;">
        <h1 style="font-size:3rem; font-weight:bold; text-transform:uppercase; line-height:1.1; margin:0; color:#4B2E2E;">
            HISTORIAS DE IMPACTO
        </h1>
        <h2 style="font-size:2rem; font-weight:bold; margin:0; color:#D8A5AB;">
            SAN JUAN DEL RÍO
        </h2>
    </div>

    <p class="text-center text-muted mb-4" style="font-size:1.1rem;">
        Conoce las historias de impacto que transforman vidas y dejan huella en nuestra comunidad
    </p>

    <!-- Colores de fondo para las tarjetas -->
    <?php $bgColors = ['#F5F0E1', '#EAD9B7', '#C79CA0', '#9CA88B']; $index = 0; ?>

    <!-- Contenedor de historias -->
    <div class="row g-4">
        <?php foreach ($historias as $historia): ?>
            <?php $bg = $bgColors[$index % count($bgColors)]; ?>
            <div class="col-md-6">
                <div class="row align-items-center story-card" style="background-color:<?= $bg ?>; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,0.1);">

                    <!-- Imagen a la izquierda -->
                    <div class="col-4 p-0" style="max-width:150px;">
                        <?php if (!empty($historia->imagen)): ?>
                            <img src="<?= $historia->getImagenUrl() ?>" alt="<?= htmlspecialchars($historia->titulo) ?>" style="width:100%; height:auto; border-radius:8px;">
                        <?php else: ?>
                            <img src="/proyecto/default/public/img/no-image.png" alt="Sin imagen" style="width:100%; height:auto; border-radius:8px;">
                        <?php endif; ?>
                    </div>

                    <!-- Información a la derecha -->
                    <div class="col-8 p-4 d-flex flex-column justify-content-between">
                        <div>
                            <h5><?= htmlspecialchars($historia->titulo) ?></h5>
                            <p><?= substr(htmlspecialchars($historia->descripcion), 0, 100) ?>...</p>

                            <!-- Datos adicionales -->
                            <ul style="list-style:none; padding-left:0; font-size:0.9rem;">
                                <li><strong>Fecha:</strong> <?= htmlspecialchars(date('d/m/Y', strtotime($historia->fecha))) ?></li>
                                <li><strong>Campaña:</strong> <?= htmlspecialchars($historia->campana ? $historia->campana->nombre : '-') ?></li>
                                <li><strong>Donador:</strong> <?= htmlspecialchars($historia->donador ? $historia->donador->nombre : '-') ?></li>
                            </ul>
                        </div>

                        <!-- Botones -->
                        <div class="d-flex justify-content-between mt-3">
                            <?= Html::link("/historias_impacto/ver/{$historia->id}", "Ver más", [
                                "class" => "btn btn-sm btn-success",
                                "style" => "background-color:#4B2E2E; border:none;"
                            ]) ?>

                            <?= Html::link("/historias_impacto/editar/{$historia->id}", "Editar", [
                                "class" => "btn btn-sm btn-warning",
                                "style" => "background-color:#C79CA0; border:none;"
                            ]) ?>
                        </div>
                    </div>

                </div>
            </div>
            <?php $index++; ?>
        <?php endforeach; ?>
    </div>

    <!-- Botón registrar -->
    <div class="d-flex justify-content-end mt-4">
        <?= Html::link("/historias_impacto/registrar", "NUEVA HISTORIA", [
            "class" => "btn btn-success",
            "style" => "background-color:#7A9E7E; border:none; font-weight:bold;"
        ]) ?>
    </div>
</div>
